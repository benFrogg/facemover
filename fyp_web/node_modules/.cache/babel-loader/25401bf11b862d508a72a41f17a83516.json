{"ast":null,"code":"var _jsxFileName = \"D:\\\\FYP_Face_Animation\\\\fyp_full\\\\fyp_web\\\\src\\\\components\\\\Animator\\\\ImageAndFeature.js\",\n    _s = $RefreshSig$();\n\nimport { Center, Text, Heading, VStack, HStack, SimpleGrid, Spinner } from \"@chakra-ui/react\";\nimport { ChakraProvider } from \"@chakra-ui/react\";\nimport React, { useEffect, useState } from \"react\";\nimport TreeView from \"@mui/lab/TreeView\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport ChevronRightIcon from \"@mui/icons-material/ChevronRight\";\nimport TreeItem from \"@mui/lab/TreeItem\";\nimport \"./ImageAndFeature.css\";\nimport axios from \"axios\";\nimport ReactPlayer from \"react-player\";\nimport testVid from \"../../img/bg_vid.mp4\";\nimport VideoPlayer from 'react-video-js-player';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst data = {\n  key: \"feature\",\n  label: \"Features\",\n  children: [{\n    key: \"1\",\n    label: \"Facial Expression\"\n  }, {\n    key: \"2\",\n    label: \"Eye Movement\"\n  }, {\n    key: \"GC\",\n    label: \"Gender Customization\",\n    children: [{\n      key: \"3\",\n      label: \"Female\"\n    }, {\n      key: \"4\",\n      label: \"Male\"\n    }]\n  }, {\n    key: \"FA\",\n    label: \"Face Aging\",\n    children: [{\n      key: \"5\",\n      label: \"Older\"\n    }, {\n      key: \"6\",\n      label: \"Younger\"\n    }]\n  }, {\n    key: \"7\",\n    label: \"Anime-Style\"\n  }, {\n    key: \"PA\",\n    label: \"Produce Audio\",\n    children: [{\n      key: \"8\",\n      label: \"Cartoon - Bye\"\n    }, {\n      key: \"9\",\n      label: \"Cartoon - Hello\"\n    }, {\n      key: \"10\",\n      label: \"Woman - Bye\"\n    }, {\n      key: \"11\",\n      label: \"Woman - Hello\"\n    }, {\n      key: \"12\",\n      label: \"Man - Bye\"\n    }, {\n      key: \"13\",\n      label: \"Man - Hello\"\n    }]\n  }]\n};\n\nfunction ImageAndFeature() {\n  _s();\n\n  const [selectedFeature, setSelectedFeature] = useState(null);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [uploadSuccessful, setUploadSuccessful] = useState(false);\n  const [showSpinner, setShowSpinner] = useState(false);\n  const [outputImg, setOutputImg] = useState(null);\n  const regex = /^[0-9\\b]+$/;\n\n  const NodeSelect = (event, nodeId) => {\n    if (regex.test(nodeId)) {\n      setSelectedFeature(nodeId);\n      console.log(nodeId);\n    } else {\n      setSelectedFeature(null);\n      console.log(nodeId);\n    }\n  };\n\n  const renderTree = features => /*#__PURE__*/_jsxDEV(TreeItem, {\n    nodeId: features.key,\n    label: features.label,\n    children: Array.isArray(features.children) ? features.children.map(feature => renderTree(feature)) : null\n  }, features.key, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this); // useEffect(() => {\n  //   console.log(\"Feature selected: \", selectedFeature);\n  //   const url = `/output-image`;\n  //   axios.get(url, { responseType: \"blob\" }).then((res) => {\n  //     var imageUrl = URL.createObjectURL(res.data);\n  //     setOutputImg(imageUrl);\n  //     console.log(\"Output image\", outputImg)\n  //   });\n  // }, [uploadSuccessful]);\n\n\n  useEffect(() => {\n    getOutput();\n  }, []);\n\n  async function getOutput() {\n    await axios.get(\"/output-image\", {\n      responseType: \"blob\"\n    }).then(response => {\n      var imageUrl = URL.createObjectURL(response.data);\n      setOutputImg(imageUrl);\n      console.log(\"Output image\", outputImg);\n    }).catch(error => {\n      console.error(\"Error fetching data: \", error);\n    });\n  }\n\n  const onInputChange = e => {\n    console.log(e.target.files[0]);\n    setSelectedFile(e.target.files[0]);\n  };\n\n  const onButtonClick = e => {\n    console.log(\"Button clicked..\");\n    e.target.value = \"\";\n  };\n\n  const transformImage = e => {\n    setShowSpinner(true);\n    console.log(\"UploadFeature\", selectedFeature);\n    const formData = new FormData();\n    formData.append(\"file\", selectedFile, selectedFile.name);\n    const requestOptions = {\n      method: \"POST\",\n      body: formData\n    };\n    fetch(\"/get-image\", requestOptions).then(response => response.json()).then(data => {\n      console.log(\"Image sent\");\n      setUploadSuccessful(!uploadSuccessful);\n      setShowSpinner(false);\n      setSelectedFile(null);\n    });\n  };\n\n  const sendFeatureID = e => {\n    axios.post(\"/get-feature\", {\n      feature_id: selectedFeature\n    }).then(function (response) {\n      console.log(\"Feature sent\");\n    });\n  }; // const getOutputImg = setInterval(function () {\n  //   const url = `/output-image`;\n  //   axios.get(url, { responseType: \"blob\" }).then((res) => {\n  //     var imageUrl = URL.createObjectURL(res.data);\n  //     setOutputImg(imageUrl);\n  //   });\n  // }, 15000);\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Contents\",\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"animateItem\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"items\",\n          children: /*#__PURE__*/_jsxDEV(ChakraProvider, {\n            children: /*#__PURE__*/_jsxDEV(Center, {\n              sx: {\n                padding: 8,\n                width: \"fit-content\",\n                height: \"500px\",\n                border: \"solid white\"\n              },\n              children: /*#__PURE__*/_jsxDEV(VStack, {\n                spacing: 7,\n                children: [/*#__PURE__*/_jsxDEV(Heading, {\n                  children: \"Upload your Image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 219,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Text, {\n                  children: \"/* accepted files (.png, .jpg) */\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(HStack, {\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    style: {\n                      marginLeft: \"80px\"\n                    },\n                    type: \"file\",\n                    onChange: onInputChange,\n                    onClick: onButtonClick\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 222,\n                    columnNumber: 21\n                  }, this), showSpinner && /*#__PURE__*/_jsxDEV(Center, {\n                    children: /*#__PURE__*/_jsxDEV(Spinner, {\n                      size: \"xl\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 230,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 229,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 221,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Heading, {\n                  children: \"Preview\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(SimpleGrid, {\n                  columns: 3,\n                  spacing: 8\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"items\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inputFeat\",\n            style: {\n              marginLeft: \"auto\",\n              marginRight: \"auto\",\n              width: \"450px\",\n              height: \"500px\",\n              border: \"solid white\"\n            },\n            children: /*#__PURE__*/_jsxDEV(TreeView, {\n              defaultCollapseIcon: /*#__PURE__*/_jsxDEV(ExpandMoreIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 38\n              }, this),\n              defaultExpanded: [\"feature\"],\n              defaultExpandIcon: /*#__PURE__*/_jsxDEV(ChevronRightIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 36\n              }, this),\n              sx: {\n                height: 110,\n                flexGrow: 1,\n                marginTop: 4,\n                marginLeft: 2\n              },\n              onNodeSelect: NodeSelect,\n              children: [renderTree(data), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  height: \"60px\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  alignItems: \"center\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: function (event) {\n                    transformImage();\n                    sendFeatureID(); // getOutputImg();\n                  },\n                  children: \"Transform!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"items\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              height: \"500px\",\n              width: \"450px\",\n              textAlign: \"center\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              border: \"solid white\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: outputImg,\n              className: \"outputGif\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ImageAndFeature, \"LCiDjtbhQU6e2SJBaLgfQ7kFBpA=\");\n\n_c = ImageAndFeature;\nexport default ImageAndFeature;\n\nvar _c;\n\n$RefreshReg$(_c, \"ImageAndFeature\");","map":{"version":3,"sources":["D:/FYP_Face_Animation/fyp_full/fyp_web/src/components/Animator/ImageAndFeature.js"],"names":["Center","Text","Heading","VStack","HStack","SimpleGrid","Spinner","ChakraProvider","React","useEffect","useState","TreeView","ExpandMoreIcon","ChevronRightIcon","TreeItem","axios","ReactPlayer","testVid","VideoPlayer","data","key","label","children","ImageAndFeature","selectedFeature","setSelectedFeature","selectedFile","setSelectedFile","uploadSuccessful","setUploadSuccessful","showSpinner","setShowSpinner","outputImg","setOutputImg","regex","NodeSelect","event","nodeId","test","console","log","renderTree","features","Array","isArray","map","feature","getOutput","get","responseType","then","response","imageUrl","URL","createObjectURL","catch","error","onInputChange","e","target","files","onButtonClick","value","transformImage","formData","FormData","append","name","requestOptions","method","body","fetch","json","sendFeatureID","post","feature_id","padding","width","height","border","marginLeft","marginRight","flexGrow","marginTop","display","justifyContent","alignItems","textAlign"],"mappings":";;;AAAA,SACEA,MADF,EAEEC,IAFF,EAGEC,OAHF,EAIEC,MAJF,EAKEC,MALF,EAMEC,UANF,EAOEC,OAPF,QAQO,kBARP;AAUA,SAASC,cAAT,QAA+B,kBAA/B;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,QAAP,MAAqB,mBAArB;AACA,OAAOC,cAAP,MAA2B,gCAA3B;AACA,OAAOC,gBAAP,MAA6B,kCAA7B;AACA,OAAOC,QAAP,MAAqB,mBAArB;AACA,OAAO,uBAAP;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,cAAxB;AACA,OAAOC,OAAP,MAAoB,sBAApB;AACA,OAAOC,WAAP,MAAwB,uBAAxB;;AAEA,MAAMC,IAAI,GAAG;AACXC,EAAAA,GAAG,EAAE,SADM;AAEXC,EAAAA,KAAK,EAAE,UAFI;AAGXC,EAAAA,QAAQ,EAAE,CACR;AACEF,IAAAA,GAAG,EAAE,GADP;AAEEC,IAAAA,KAAK,EAAE;AAFT,GADQ,EAKR;AACED,IAAAA,GAAG,EAAE,GADP;AAEEC,IAAAA,KAAK,EAAE;AAFT,GALQ,EASR;AACED,IAAAA,GAAG,EAAE,IADP;AAEEC,IAAAA,KAAK,EAAE,sBAFT;AAGEC,IAAAA,QAAQ,EAAE,CACR;AACEF,MAAAA,GAAG,EAAE,GADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KADQ,EAKR;AACED,MAAAA,GAAG,EAAE,GADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KALQ;AAHZ,GATQ,EAuBR;AACED,IAAAA,GAAG,EAAE,IADP;AAEEC,IAAAA,KAAK,EAAE,YAFT;AAGEC,IAAAA,QAAQ,EAAE,CACR;AACEF,MAAAA,GAAG,EAAE,GADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KADQ,EAKR;AACED,MAAAA,GAAG,EAAE,GADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KALQ;AAHZ,GAvBQ,EAqCR;AACED,IAAAA,GAAG,EAAE,GADP;AAEEC,IAAAA,KAAK,EAAE;AAFT,GArCQ,EAyCR;AACED,IAAAA,GAAG,EAAE,IADP;AAEEC,IAAAA,KAAK,EAAE,eAFT;AAGEC,IAAAA,QAAQ,EAAE,CACR;AACEF,MAAAA,GAAG,EAAE,GADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KADQ,EAKR;AACED,MAAAA,GAAG,EAAE,GADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KALQ,EASR;AACED,MAAAA,GAAG,EAAE,IADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KATQ,EAaR;AACED,MAAAA,GAAG,EAAE,IADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KAbQ,EAiBR;AACED,MAAAA,GAAG,EAAE,IADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KAjBQ,EAqBR;AACED,MAAAA,GAAG,EAAE,IADP;AAEEC,MAAAA,KAAK,EAAE;AAFT,KArBQ;AAHZ,GAzCQ;AAHC,CAAb;;AA6EA,SAASE,eAAT,GAA2B;AAAA;;AACzB,QAAM,CAACC,eAAD,EAAkBC,kBAAlB,IAAwCf,QAAQ,CAAC,IAAD,CAAtD;AACA,QAAM,CAACgB,YAAD,EAAeC,eAAf,IAAkCjB,QAAQ,CAAC,IAAD,CAAhD;AACA,QAAM,CAACkB,gBAAD,EAAmBC,mBAAnB,IAA0CnB,QAAQ,CAAC,KAAD,CAAxD;AACA,QAAM,CAACoB,WAAD,EAAcC,cAAd,IAAgCrB,QAAQ,CAAC,KAAD,CAA9C;AACA,QAAM,CAACsB,SAAD,EAAYC,YAAZ,IAA4BvB,QAAQ,CAAC,IAAD,CAA1C;AACA,QAAMwB,KAAK,GAAG,YAAd;;AAEA,QAAMC,UAAU,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;AACpC,QAAIH,KAAK,CAACI,IAAN,CAAWD,MAAX,CAAJ,EAAwB;AACtBZ,MAAAA,kBAAkB,CAACY,MAAD,CAAlB;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYH,MAAZ;AACD,KAHD,MAGO;AACLZ,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAc,MAAAA,OAAO,CAACC,GAAR,CAAYH,MAAZ;AACD;AACF,GARD;;AAUA,QAAMI,UAAU,GAAIC,QAAD,iBACjB,QAAC,QAAD;AAA6B,IAAA,MAAM,EAAEA,QAAQ,CAACtB,GAA9C;AAAmD,IAAA,KAAK,EAAEsB,QAAQ,CAACrB,KAAnE;AAAA,cACGsB,KAAK,CAACC,OAAN,CAAcF,QAAQ,CAACpB,QAAvB,IACGoB,QAAQ,CAACpB,QAAT,CAAkBuB,GAAlB,CAAuBC,OAAD,IAAaL,UAAU,CAACK,OAAD,CAA7C,CADH,GAEG;AAHN,KAAeJ,QAAQ,CAACtB,GAAxB;AAAA;AAAA;AAAA;AAAA,UADF,CAlByB,CA0BzB;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEAX,EAAAA,SAAS,CAAC,MAAM;AACdsC,IAAAA,SAAS;AACV,GAFQ,EAEN,EAFM,CAAT;;AAIA,iBAAeA,SAAf,GAA2B;AACzB,UAAMhC,KAAK,CAACiC,GAAN,CAAU,eAAV,EAA2B;AAACC,MAAAA,YAAY,EAAE;AAAf,KAA3B,EACLC,IADK,CACCC,QAAD,IAAc;AAClB,UAAIC,QAAQ,GAAGC,GAAG,CAACC,eAAJ,CAAoBH,QAAQ,CAAChC,IAA7B,CAAf;AACAc,MAAAA,YAAY,CAACmB,QAAD,CAAZ;AACAb,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BR,SAA5B;AACD,KALK,EAMLuB,KANK,CAMEC,KAAD,IAAW;AAChBjB,MAAAA,OAAO,CAACiB,KAAR,CAAc,uBAAd,EAAuCA,KAAvC;AACD,KARK,CAAN;AASD;;AAED,QAAMC,aAAa,GAAIC,CAAD,IAAO;AAC3BnB,IAAAA,OAAO,CAACC,GAAR,CAAYkB,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAZ;AAEAjC,IAAAA,eAAe,CAAC+B,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAf;AACD,GAJD;;AAMA,QAAMC,aAAa,GAAIH,CAAD,IAAO;AAC3BnB,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAkB,IAAAA,CAAC,CAACC,MAAF,CAASG,KAAT,GAAiB,EAAjB;AACD,GAHD;;AAKA,QAAMC,cAAc,GAAIL,CAAD,IAAO;AAC5B3B,IAAAA,cAAc,CAAC,IAAD,CAAd;AACAQ,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BhB,eAA7B;AACA,UAAMwC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,IAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBxC,YAAxB,EAAsCA,YAAY,CAACyC,IAAnD;AAEA,UAAMC,cAAc,GAAG;AACrBC,MAAAA,MAAM,EAAE,MADa;AAErBC,MAAAA,IAAI,EAAEN;AAFe,KAAvB;AAKAO,IAAAA,KAAK,CAAC,YAAD,EAAeH,cAAf,CAAL,CACGlB,IADH,CACSC,QAAD,IAAcA,QAAQ,CAACqB,IAAT,EADtB,EAEGtB,IAFH,CAES/B,IAAD,IAAU;AACdoB,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACAX,MAAAA,mBAAmB,CAAC,CAACD,gBAAF,CAAnB;AACAG,MAAAA,cAAc,CAAC,KAAD,CAAd;AACAJ,MAAAA,eAAe,CAAC,IAAD,CAAf;AACD,KAPH;AAQD,GAnBD;;AAqBA,QAAM8C,aAAa,GAAIf,CAAD,IAAO;AAC3B3C,IAAAA,KAAK,CACF2D,IADH,CACQ,cADR,EACwB;AACpBC,MAAAA,UAAU,EAAEnD;AADQ,KADxB,EAIG0B,IAJH,CAIQ,UAAUC,QAAV,EAAoB;AACxBZ,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACD,KANH;AAOD,GARD,CArFyB,CA+FzB;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,sBACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA,2BAEE;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA,6BACE;AAAI,QAAA,SAAS,EAAC,aAAd;AAAA,gCACE;AAAI,UAAA,SAAS,EAAC,OAAd;AAAA,iCACE,QAAC,cAAD;AAAA,mCACE,QAAC,MAAD;AACE,cAAA,EAAE,EAAE;AACFoC,gBAAAA,OAAO,EAAE,CADP;AAEFC,gBAAAA,KAAK,EAAE,aAFL;AAGFC,gBAAAA,MAAM,EAAE,OAHN;AAIFC,gBAAAA,MAAM,EAAE;AAJN,eADN;AAAA,qCAQE,QAAC,MAAD;AAAQ,gBAAA,OAAO,EAAE,CAAjB;AAAA,wCACE,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF,eAGE,QAAC,MAAD;AAAA,0CACE;AACE,oBAAA,KAAK,EAAE;AAAEC,sBAAAA,UAAU,EAAE;AAAd,qBADT;AAEE,oBAAA,IAAI,EAAC,MAFP;AAGE,oBAAA,QAAQ,EAAEvB,aAHZ;AAIE,oBAAA,OAAO,EAAEI;AAJX;AAAA;AAAA;AAAA;AAAA,0BADF,EAOG/B,WAAW,iBACV,QAAC,MAAD;AAAA,2CACE,QAAC,OAAD;AAAS,sBAAA,IAAI,EAAC;AAAd;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BARJ;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHF,eAgBE,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAhBF,eAiBE,QAAC,UAAD;AAAY,kBAAA,OAAO,EAAE,CAArB;AAAwB,kBAAA,OAAO,EAAE;AAAjC;AAAA;AAAA;AAAA;AAAA,wBAjBF;AAAA;AAAA;AAAA;AAAA;AAAA;AARF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAoCE;AAAI,UAAA,SAAS,EAAC,OAAd;AAAA,iCACE;AACE,YAAA,SAAS,EAAC,WADZ;AAEE,YAAA,KAAK,EAAE;AACLkD,cAAAA,UAAU,EAAE,MADP;AAELC,cAAAA,WAAW,EAAE,MAFR;AAGLJ,cAAAA,KAAK,EAAE,OAHF;AAILC,cAAAA,MAAM,EAAE,OAJH;AAKLC,cAAAA,MAAM,EAAE;AALH,aAFT;AAAA,mCAUE,QAAC,QAAD;AACE,cAAA,mBAAmB,eAAE,QAAC,cAAD;AAAA;AAAA;AAAA;AAAA,sBADvB;AAEE,cAAA,eAAe,EAAE,CAAC,SAAD,CAFnB;AAGE,cAAA,iBAAiB,eAAE,QAAC,gBAAD;AAAA;AAAA;AAAA;AAAA,sBAHrB;AAIE,cAAA,EAAE,EAAE;AAAED,gBAAAA,MAAM,EAAE,GAAV;AAAeI,gBAAAA,QAAQ,EAAE,CAAzB;AAA4BC,gBAAAA,SAAS,EAAE,CAAvC;AAA0CH,gBAAAA,UAAU,EAAE;AAAtD,eAJN;AAKE,cAAA,YAAY,EAAE7C,UALhB;AAAA,yBAOGM,UAAU,CAACtB,IAAD,CAPb,eAQE;AAAK,gBAAA,KAAK,EAAE;AAAE2D,kBAAAA,MAAM,EAAE;AAAV;AAAZ;AAAA;AAAA;AAAA;AAAA,sBARF,eASE;AACE,gBAAA,KAAK,EAAE;AACLM,kBAAAA,OAAO,EAAE,MADJ;AAELC,kBAAAA,cAAc,EAAE,QAFX;AAGLC,kBAAAA,UAAU,EAAE;AAHP,iBADT;AAAA,uCAOE;AACE,kBAAA,OAAO,EAAE,UAAUlD,KAAV,EAAiB;AACxB2B,oBAAAA,cAAc;AACdU,oBAAAA,aAAa,GAFW,CAGxB;AACD,mBALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAPF;AAAA;AAAA;AAAA;AAAA,sBATF;AAAA;AAAA;AAAA;AAAA;AAAA;AAVF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBApCF,eA4EE;AAAI,UAAA,SAAS,EAAC,OAAd;AAAA,iCACE;AACE,YAAA,KAAK,EAAE;AACLK,cAAAA,MAAM,EAAE,OADH;AAELD,cAAAA,KAAK,EAAE,OAFF;AAGLU,cAAAA,SAAS,EAAE,QAHN;AAILH,cAAAA,OAAO,EAAE,MAJJ;AAKLC,cAAAA,cAAc,EAAE,QALX;AAMLC,cAAAA,UAAU,EAAE,QANP;AAOLP,cAAAA,MAAM,EAAE;AAPH,aADT;AAAA,mCAWE;AAAK,cAAA,GAAG,EAAE/C,SAAV;AAAsB,cAAA,SAAS,EAAC;AAAhC;AAAA;AAAA;AAAA;AAAA;AAXF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBA5EF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AAFF;AAAA;AAAA;AAAA;AAAA,UADF;AAoGD;;GA3MQT,e;;KAAAA,e;AA6MT,eAAeA,eAAf","sourcesContent":["import {\r\n  Center,\r\n  Text,\r\n  Heading,\r\n  VStack,\r\n  HStack,\r\n  SimpleGrid,\r\n  Spinner,\r\n} from \"@chakra-ui/react\";\r\n\r\nimport { ChakraProvider } from \"@chakra-ui/react\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport TreeView from \"@mui/lab/TreeView\";\r\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\r\nimport ChevronRightIcon from \"@mui/icons-material/ChevronRight\";\r\nimport TreeItem from \"@mui/lab/TreeItem\";\r\nimport \"./ImageAndFeature.css\";\r\nimport axios from \"axios\";\r\nimport ReactPlayer from \"react-player\";\r\nimport testVid from \"../../img/bg_vid.mp4\";\r\nimport VideoPlayer from 'react-video-js-player'\r\n\r\nconst data = {\r\n  key: \"feature\",\r\n  label: \"Features\",\r\n  children: [\r\n    {\r\n      key: \"1\",\r\n      label: \"Facial Expression\",\r\n    },\r\n    {\r\n      key: \"2\",\r\n      label: \"Eye Movement\",\r\n    },\r\n    {\r\n      key: \"GC\",\r\n      label: \"Gender Customization\",\r\n      children: [\r\n        {\r\n          key: \"3\",\r\n          label: \"Female\",\r\n        },\r\n        {\r\n          key: \"4\",\r\n          label: \"Male\",\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      key: \"FA\",\r\n      label: \"Face Aging\",\r\n      children: [\r\n        {\r\n          key: \"5\",\r\n          label: \"Older\",\r\n        },\r\n        {\r\n          key: \"6\",\r\n          label: \"Younger\",\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      key: \"7\",\r\n      label: \"Anime-Style\",\r\n    },\r\n    {\r\n      key: \"PA\",\r\n      label: \"Produce Audio\",\r\n      children: [\r\n        {\r\n          key: \"8\",\r\n          label: \"Cartoon - Bye\",\r\n        },\r\n        {\r\n          key: \"9\",\r\n          label: \"Cartoon - Hello\",\r\n        },\r\n        {\r\n          key: \"10\",\r\n          label: \"Woman - Bye\",\r\n        },\r\n        {\r\n          key: \"11\",\r\n          label: \"Woman - Hello\",\r\n        },\r\n        {\r\n          key: \"12\",\r\n          label: \"Man - Bye\",\r\n        },\r\n        {\r\n          key: \"13\",\r\n          label: \"Man - Hello\",\r\n        },\r\n      ],\r\n    },\r\n  ],\r\n};\r\n\r\nfunction ImageAndFeature() {\r\n  const [selectedFeature, setSelectedFeature] = useState(null);\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [uploadSuccessful, setUploadSuccessful] = useState(false);\r\n  const [showSpinner, setShowSpinner] = useState(false);\r\n  const [outputImg, setOutputImg] = useState(null);\r\n  const regex = /^[0-9\\b]+$/;\r\n\r\n  const NodeSelect = (event, nodeId) => {\r\n    if (regex.test(nodeId)) {\r\n      setSelectedFeature(nodeId);\r\n      console.log(nodeId);\r\n    } else {\r\n      setSelectedFeature(null);\r\n      console.log(nodeId);\r\n    }\r\n  };\r\n\r\n  const renderTree = (features) => (\r\n    <TreeItem key={features.key} nodeId={features.key} label={features.label}>\r\n      {Array.isArray(features.children)\r\n        ? features.children.map((feature) => renderTree(feature))\r\n        : null}\r\n    </TreeItem>\r\n  );\r\n\r\n  // useEffect(() => {\r\n  //   console.log(\"Feature selected: \", selectedFeature);\r\n\r\n  //   const url = `/output-image`;\r\n  //   axios.get(url, { responseType: \"blob\" }).then((res) => {\r\n  //     var imageUrl = URL.createObjectURL(res.data);\r\n  //     setOutputImg(imageUrl);\r\n  //     console.log(\"Output image\", outputImg)\r\n  //   });\r\n  // }, [uploadSuccessful]);\r\n\r\n  useEffect(() => {\r\n    getOutput()\r\n  }, [])\r\n\r\n  async function getOutput() {\r\n    await axios.get(\"/output-image\", {responseType: \"blob\"})\r\n    .then((response) => {\r\n      var imageUrl = URL.createObjectURL(response.data);\r\n      setOutputImg(imageUrl);\r\n      console.log(\"Output image\", outputImg)\r\n    })\r\n    .catch((error) => {\r\n      console.error(\"Error fetching data: \", error)\r\n    })\r\n  }\r\n\r\n  const onInputChange = (e) => {\r\n    console.log(e.target.files[0]);\r\n\r\n    setSelectedFile(e.target.files[0]);\r\n  };\r\n\r\n  const onButtonClick = (e) => {\r\n    console.log(\"Button clicked..\");\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const transformImage = (e) => {\r\n    setShowSpinner(true);\r\n    console.log(\"UploadFeature\", selectedFeature);\r\n    const formData = new FormData();\r\n    formData.append(\"file\", selectedFile, selectedFile.name);\r\n\r\n    const requestOptions = {\r\n      method: \"POST\",\r\n      body: formData,\r\n    };\r\n\r\n    fetch(\"/get-image\", requestOptions)\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        console.log(\"Image sent\");\r\n        setUploadSuccessful(!uploadSuccessful);\r\n        setShowSpinner(false);\r\n        setSelectedFile(null);\r\n      });\r\n  };\r\n\r\n  const sendFeatureID = (e) => {\r\n    axios\r\n      .post(\"/get-feature\", {\r\n        feature_id: selectedFeature,\r\n      })\r\n      .then(function (response) {\r\n        console.log(\"Feature sent\");\r\n      });\r\n  };\r\n\r\n  // const getOutputImg = setInterval(function () {\r\n  //   const url = `/output-image`;\r\n  //   axios.get(url, { responseType: \"blob\" }).then((res) => {\r\n  //     var imageUrl = URL.createObjectURL(res.data);\r\n  //     setOutputImg(imageUrl);\r\n  //   });\r\n  // }, 15000);\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      {/* <div className=\"filler1\"></div> */}\r\n      <div className=\"Contents\">\r\n        <ul className=\"animateItem\">\r\n          <li className=\"items\">\r\n            <ChakraProvider>\r\n              <Center\r\n                sx={{\r\n                  padding: 8,\r\n                  width: \"fit-content\",\r\n                  height: \"500px\",\r\n                  border: \"solid white\",\r\n                }}\r\n              >\r\n                <VStack spacing={7}>\r\n                  <Heading>Upload your Image</Heading>\r\n                  <Text>/* accepted files (.png, .jpg) */</Text>\r\n                  <HStack>\r\n                    <input\r\n                      style={{ marginLeft: \"80px\" }}\r\n                      type=\"file\"\r\n                      onChange={onInputChange}\r\n                      onClick={onButtonClick}\r\n                    ></input>\r\n                    {showSpinner && (\r\n                      <Center>\r\n                        <Spinner size=\"xl\" />\r\n                      </Center>\r\n                    )}\r\n                  </HStack>\r\n                  <Heading>Preview</Heading>\r\n                  <SimpleGrid columns={3} spacing={8}>\r\n                    {/*{selectedFile.map(file => Object.assign(file, {preview: URL.createObjectURL(file)}))}*/}\r\n                  </SimpleGrid>\r\n                </VStack>\r\n              </Center>\r\n            </ChakraProvider>\r\n          </li>\r\n          {/* <div className=\"filler2\"></div> */}\r\n          <li className=\"items\">\r\n            <div\r\n              className=\"inputFeat\"\r\n              style={{\r\n                marginLeft: \"auto\",\r\n                marginRight: \"auto\",\r\n                width: \"450px\",\r\n                height: \"500px\",\r\n                border: \"solid white\",\r\n              }}\r\n            >\r\n              <TreeView\r\n                defaultCollapseIcon={<ExpandMoreIcon />}\r\n                defaultExpanded={[\"feature\"]}\r\n                defaultExpandIcon={<ChevronRightIcon />}\r\n                sx={{ height: 110, flexGrow: 1, marginTop: 4, marginLeft: 2 }}\r\n                onNodeSelect={NodeSelect}\r\n              >\r\n                {renderTree(data)}\r\n                <div style={{ height: \"60px\" }}></div>\r\n                <div\r\n                  style={{\r\n                    display: \"flex\",\r\n                    justifyContent: \"center\",\r\n                    alignItems: \"center\",\r\n                  }}\r\n                >\r\n                  <button\r\n                    onClick={function (event) {\r\n                      transformImage();\r\n                      sendFeatureID();\r\n                      // getOutputImg();\r\n                    }}\r\n                  >\r\n                    Transform!\r\n                  </button>\r\n                </div>\r\n              </TreeView>\r\n            </div>\r\n          </li>\r\n          <li className=\"items\">\r\n            <div\r\n              style={{\r\n                height: \"500px\",\r\n                width: \"450px\",\r\n                textAlign: \"center\",\r\n                display: \"flex\",\r\n                justifyContent: \"center\",\r\n                alignItems: \"center\",\r\n                border: \"solid white\",\r\n              }}\r\n            >\r\n              <img src={outputImg}  className='outputGif' />\r\n              {/* <VideoPlayer src={outputImg} width=\"720\" height=\"420\" /> */}\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ImageAndFeature;\r\n"]},"metadata":{},"sourceType":"module"}